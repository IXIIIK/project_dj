<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Карточки — {{ showcase.name }}</title>
  <link rel="stylesheet" href="/static/style.css?v=17">
  <style>
    .wrap{max-width:980px;margin:24px auto;padding:0 18px}
    .crumbs{margin:0 0 12px}
    .crumbs a{color:#5A7BFF;text-decoration:none}
    .table{width:100%;border-collapse:collapse;background:#fff;border-radius:18px;overflow:hidden;box-shadow:var(--shadow)}
    .table th,.table td{padding:12px 14px;border-bottom:1px solid #eef1f6;font-size:14px;vertical-align:middle}
    .table th{background:#f9fbff;text-align:left;color:#4a5568}
    .table td a { position: static; float: none; display: inline; }
    .actions a{margin-right:8px}
    .top-actions{display:flex;justify-content:space-between;align-items:center;margin:0 0 16px}
    .btn{padding:6px 12px;border-radius:6px;background:#5A7BFF;color:#fff;text-decoration:none}
    .pager{display:flex;gap:8px;justify-content:center;margin:16px 0}
    .pager a,.pager span{padding:6px 10px;border-radius:6px;background:#f1f5f9;text-decoration:none}
    .pager .current{background:#5A7BFF;color:#fff}
  </style>
</head>
<body>

  <style>
    .table .actions { white-space: nowrap; }
    .table .actions .btn-link { margin-right: 12px; }
    .table .links div { line-height: 1.3; }
    /* на всякий случай сброс странных глобальных правил */
    .table td a { position: static; float: none; display: inline; }
  </style>

<div class="wrap">
  <div class="crumbs">
    <a href="{% url 'showcases_admin' %}">← Витрины</a>
  </div>

  <div class="top-actions">
    <h2>Карточки — {{ showcase.name }}</h2>
    <a class="btn" href="{% url 'card_add' showcase.slug %}">+ Добавить карточку</a>
  </div>

  <table class="table">
    <thead>
      <tr>
        <th>#</th>
        <th>Название</th>
        <th>Домен(ы)</th>
        <th>Тема</th>
        <th>Действия</th>
      </tr>
    </thead>
    <tbody>
      {% for c in page_obj.object_list %}
        <tr>
          <td>{{ c.id }}</td>
          <td>{{ c.title|default:"—" }}</td>
          <td>{% if c.price %}{{ c.price }} ₽{% else %}—{% endif %}</td>
          <td>
            <div>{{ c.rate_line|default:"0% в день" }}</div>
            <div>{{ c.age_line|default:"от 18 лет" }}</div>
          </td>
          <td>{% if c.active %}Вкл{% else %}Выкл{% endif %}</td>
          <td class="actions">
            <a class="btn-link" href="{% url 'card_edit' showcase.slug c.id %}">Редактировать</a>

            <form method="post" action="{% url 'card_toggle' showcase.slug c.id %}" style="display:inline">
              {% csrf_token %}
              <button type="submit" class="btn-link">
                {% if c.active %}Отключить{% else %}Включить{% endif %}
              </button>
            </form>

            <form method="post" action="{% url 'card_delete' showcase.slug c.id %}" style="display:inline"
                  onsubmit="return confirm('Удалить карточку «{{ c.title|default:"без названия" }}»?');">
              {% csrf_token %}
              <button type="submit" class="btn-link danger">Удалить</button>
            </form>
          </td>
        </tr>
      {% empty %}
        <tr><td colspan="6">Карточек ещё нет.</td></tr>
      {% endfor %}
    </tbody>
  </table>
  

  {% if page_obj.paginator.num_pages > 1 %}
  <div class="pager">
    {% if page_obj.has_previous %}<a href="?page={{ page_obj.previous_page_number }}">← Назад</a>{% endif %}
    <span class="current">{{ page_obj.number }} / {{ page_obj.paginator.num_pages }}</span>
    {% if page_obj.has_next %}<a href="?page={{ page_obj.next_page_number }}">Вперёд →</a>{% endif %}
  </div>
  {% endif %}
</div>
</body>
</html>
