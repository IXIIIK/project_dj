<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Карточки — {{ showcase.name }}</title>
  <link rel="stylesheet" href="/static/style.css?v=17">
  <style>
    .wrap{max-width:980px;margin:24px auto;padding:0 18px}
    .crumbs{margin:0 0 12px}
    .crumbs a{color:#5A7BFF;text-decoration:none}
    .table{width:100%;border-collapse:collapse;background:#fff;border-radius:18px;overflow:hidden;box-shadow:var(--shadow)}
    .table th,.table td{padding:12px 14px;border-bottom:1px solid #eef1f6;font-size:14px;vertical-align:middle}
    .table th{background:#f9fbff;text-align:left;color:#4a5568}
    .actions a{margin-right:8px}
    .top-actions{display:flex;justify-content:space-between;align-items:center;margin:0 0 16px}
    .btn{padding:6px 12px;border-radius:6px;background:#5A7BFF;color:#fff;text-decoration:none}
    .pager{display:flex;gap:8px;justify-content:center;margin:16px 0}
    .pager a,.pager span{padding:6px 10px;border-radius:6px;background:#f1f5f9;text-decoration:none}
    .pager .current{background:#5A7BFF;color:#fff}
  </style>
</head>
<body>

  <style>
    .table .actions { white-space: nowrap; }
    .table .actions .btn-link { margin-right: 12px; }
    .table .links div { line-height: 1.3; }
    /* на всякий случай сброс странных глобальных правил */
    .table td a { position: static; float: none; display: inline; }
  </style>

<div class="wrap">
  <div class="crumbs">
    <a href="{% url 'showcases_admin' %}">← Витрины</a>
  </div>

  <div class="top-actions">
    <h2>Карточки — {{ showcase.name }}</h2>
    <a class="btn" href="{% url 'card_add' showcase.slug %}">+ Добавить карточку</a>
  </div>

  <table class="table">
    <thead>
      <tr>
        <th>#</th>
        <th>Название</th>
        <th>Домен(ы)</th>
        <th>Тема</th>
        <th>Ссылки</th>
        <th>Действия</th>
      </tr>
    </thead>
    <tbody>
      {% for sc in page_obj.object_list %}
        <tr>
          <td>{{ sc.id }}</td>
          <td>{{ sc.name }}</td>
  
          <td>
            {% with sc.domains_list as hosts %}
              {% if hosts %}{{ hosts|join:", " }}{% else %}&mdash;{% endif %}
            {% endwith %}
          </td>
  
          <td>{{ sc.template|default:"—" }}</td>
  
          <td class="links">
            {% with sc.domains_list as hosts %}
              {% if hosts %}
                {% for host in hosts %}
                  <div>
                    <a href="http://{{ host }}{% if sc.slug %}/{{ sc.slug }}{% else %}/{{ sc.id }}{% endif %}/" target="_blank">
                      {{ host }}{% if sc.slug %}/{{ sc.slug }}{% else %}/{{ sc.id }}{% endif %}/
                    </a>
                  </div>
                {% endfor %}
              {% else %}
                <div>
                  <a href="/{% if sc.slug %}{{ sc.slug }}{% else %}{{ sc.id }}{% endif %}/" target="_blank">
                    /{% if sc.slug %}{{ sc.slug }}{% else %}{{ sc.id }}{% endif %}/
                  </a>
                </div>
              {% endif %}
            {% endwith %}
          </td>
  
          <td class="actions">
            <a class="btn-sm" href="{% url 'cards_admin' sc.id %}">Карточки</a>
            <a class="btn-sm" href="{% url 'showcase_edit' sc.id %}">Редактировать</a>
            <a class="btn-sm danger"
               href="{% url 'showcase_delete' sc.id %}"
               onclick="return confirm('Удалить витрину «{{ sc.name }}»?')">
              Удалить
            </a>
          </td>
        </tr>
      {% empty %}
        <tr><td colspan="6">Витрин пока нет.</td></tr>
      {% endfor %}
    </tbody>
  </table>
  

  {% if page_obj.paginator.num_pages > 1 %}
  <div class="pager">
    {% if page_obj.has_previous %}<a href="?page={{ page_obj.previous_page_number }}">← Назад</a>{% endif %}
    <span class="current">{{ page_obj.number }} / {{ page_obj.paginator.num_pages }}</span>
    {% if page_obj.has_next %}<a href="?page={{ page_obj.next_page_number }}">Вперёд →</a>{% endif %}
  </div>
  {% endif %}
</div>
</body>
</html>
